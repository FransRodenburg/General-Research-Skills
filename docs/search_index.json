[["index.html", "General Research Skills Preface", " General Research Skills Dr. F.J. Rodenburg Â© 20202021 Universiteit Leiden Preface Every year there are several students without immediate access to the university course material. In addition, students will lose access to old course material eventually. To address these issues, as well as to improve expectation management, this online version of the entire course is being developed. You can view each days lectures, exercises, and references to the book. This online course is a continuation of the biostatistics portfolio. The portfolio, as well as the online version of the course are a work in progress. Please check back later for updates. Always consult Brightspace for the latest information on the schedule, the course material and the exam. "],["installation-tutorial.html", "Chapter 1 Installation &amp; Tutorial 1.1 Installation Guide 1.2 About RStudio &amp; R Markdown 1.3 About the R Language 1.4 Tutorials", " Chapter 1 Installation &amp; Tutorial Throughout this course, we will use RStudio. To use RStudio, you need to install both R and RStudio. (Even if you have an existing version, I recommend getting the latest version using the guide below.) 1.1 Installation Guide If youre comfortable with computer software, it boils down to: Install R; Install RStudio; Open RStudio and try to knit a template R markdown file. If you cant knit to PDF, see the note below and try knitting to HTML instead. Note about TinyTeX TinyTeX is not required for this course. If you want to knit to PDF, you have to install TinyTeX. This has several advantages over HTML and Word, which are explained in the second video. For the portfolio, all you need is a working version of RStudio, and to be able to knit to HTML. Note about installation problems in general To ensure a smooth experience throughout the course, address installation issues early on. If youre following this course in the context of your biology education at Leiden University, you can always contact Dr. H.G.J. van Mil or me about installation issues. Otherwise, see the general tips below, or try asking a question on Stackoverflow. Some general tips that will save you a lot of headaches with software during your education: Setting your system language to English (Windows, Mac) makes everything a lot easier to find; If you store data in Excel, setting the decimal separator to a dot (.) instead of a comma (,) will also save you a lot of extra effort; If you are on Windows, I highly recommend working on an account with administrator rights and setting user account control to Never notify. (Link says Windows 7 &amp; 8, but it works the same for Windows 10.) 1.2 About RStudio &amp; R Markdown Watch the video on the RStudio interface below. 1.3 About the R Language There are two great tutorial for learning the basics in R. This video shows how to use them: 1.4 Tutorials Every day there will be exercises in RStudio to teach you how to program, how to run your own analyses and how to interpret output. The optional exercises are for those who want to improve their statistics beyond what is required to pass the course. 1.4.1 Exercise: swirl Watch the part about swirl and complete chapters 1, 2, 4, 7 &amp; 8 from the R Programming course. 1.4.2 Exercise learnr (optional) Many data scientists prefer the tidyverse over base R. This is a collection of packages aimed at writing code in a more tidy manner, using the pipeline notation. Complete the Data basics, Filter observations, Create new variables and Summarise Tables chapters from the learnr package as explained in the video. (If you dont see a Tutorial tab, try running install.packages(\"learnr\") in the console and then restart RStudio.) From here on out, I will assume basic familiarity with R syntax and the RStudio interface. "],["random-variables.html", "Chapter 2 Random Variables 2.1 What are Random Variables? 2.2 Degrees of Freedom", " Chapter 2 Random Variables In this chapter by Dr. H.G.J. van Mil, the concept of a random variable is explained. 2.1 What are Random Variables? In empirical science, we draw conclusions about some larger population, using only a limited sample. This process is called inference, and it draws heavily from the definition of a random variable. Though this chapter may seem somewhat abstract, it is important that you have at least some idea what a random variable is. In experiments, random samples are taken to extract particular properties from a population of interest; e.g. we pick randomly 20 students from the population of GRS students in 2021. We will discuss this in more detail in day 2 during the lecture on Experimental Design, but for now assume, as an example, that we are able to pick 20 individuals at random from the population of GRS students from Leiden. In the natural sciences, we might not be interested in these individuals per se, but rather in some properties of interest of the population that can be inferred from this group of 20 individuals; e.g. their height, age, or eye color. In all of these cases this property can be translated into a numeric values; e.g. 180 cm of height, 10 years since birth or enrollment to the university (academic age), and an integer representing the number of brown eyes in our sample (numbers 020). The numbers generated by these experiments are called random numbers, and the variable that they represent, like height or the number of brown eyes is called a random variable. Some properties of Random variable of interest relevant in this to this course: We cannot predict the value of a random variable with absolute precision. Every new sample generates new random variable values. e.g. new samples of 20 students can give different numbers of brown eyes. Functions base on random variables are also random variables. The function that calculates the mean takes random variables as input and therefore is also a random variable. New samples can give different means. Because random variables can take different values, there is a distribution associated with it. The distribution of the ages of biology students in Leiden. The distributions of the sample means if we repeat our experiment (important notion in statistics). *The distribution of number of brown eyes in sample of 20 students GRS. In the screencast below, I discuss random variables in more detail: To summarize: Random variables (RV) are the starting point of probability theory and statistics. Statistics is built upon a solid foundation of mathematics. The number of RVs can sometimes be expressed in degrees of freedom if statistics like the mean are involved in a calculation. Statistics like the mean, variance, and standard deviation (SD) are random variables, and have their own distributions and statistics; e.g. you can estimate the SD of the distribution of means. Statistics are estimates, how good are our estimates? This can be expressed through the standard error (SE). Can we extract information from random variables? Yes, and you will learn this in this course! The probability theoretical basis is solid, and not vague, but exact. Vagueness in statistics is due to the quality of data (experimental design). Next we address the problem of how we can extract information from random variables. It turns out that statistics has found a way to partition a random variable in a systemic and informative part, and a random part called the error. This will introduce the concepts of degrees of freedom of the statistical model and the random stochastic error. 2.1.1 Exercise Describe random variables in your own words in a MS-Word file and give some examples of random variables. 2.2 Degrees of Freedom Random variables, degrees of freedom and statistical models. Extracting information from random variables is the main purpose of statistics. By constructing a statistical model that has a close relationship with the hypothesis to be tested (topic of tomorrow), statistics can extract information from data. We start from the idea of the degrees of freedom of a model, and show its relation with the number of observations, thereby introducing the idea of a statistical model and the motivation for applying statistics. To summarize: If \\(n=\\text{df}_{\\text{model}}\\), we have an perfect fit; \\(\\text{df}_\\text{residuals}=0\\) is also known as a saturated model. The RHS of a statistical model, when \\(n &gt; \\text{df}_\\text{model}\\), has two parts: A deterministic part: e.g. \\(\\text{BD} = \\mathbf{\\text{intercept} + \\text{slope} \\cdot \\text{conc}} + \\text{residuals}\\), which is a formal representation of our hypothesis and is informative. A stochastic or random part: e.g. \\(\\text{BD} = \\text{intercept} + \\text{slope} \\cdot \\text{conc} + \\mathbf{\\text{residuals}}\\), representing the properties of the random variable which is non-informative. The residuals represent our ignorance and uncertainty. Ignorance of this type leads to uncertainty: We can have a model for cell division predicting that the cell divides on average after 5 minutes, but will it divide after 5 minutes or will it be earlier or later? The level of our ignorance will affect the level of our confidence in our model. As the data that we sample plays such a crucial role, we must take care when acquiring our data. This is the field of experimental- or study design, the topic of our next lecture tomorrow. 2.2.1 Exercises Describe, using your own words, the relation between the topics of today, random variable, degree of freedom and statistical model; Do you agree that the source of vagueness relates to the quality of the data? Write down a argument in favor or against the above statement. "],["study-design.html", "Chapter 3 Study Design 3.1 Lecture: Study Design 3.2 Exercises", " Chapter 3 Study Design In this chapter by Dr. H.G.J. van Mil, statistical considerations of experiments or studies that ensure maximal power and generalizability. 3.1 Lecture: Study Design 3.2 Exercises "],["hypothesis-testing.html", "Chapter 4 Hypothesis Testing 4.1 Lecture: Study Design 4.2 Exercises", " Chapter 4 Hypothesis Testing In this chapter by Dr. H.G.J. van Mil, the concept of a test statistic is explained. 4.1 Lecture: Study Design 4.2 Exercises "],["statistical-tests.html", "Chapter 5 Statistical Tests 5.1 T-Test 5.2 Chi-Squared Test 5.3 Multiple Testing", " Chapter 5 Statistical Tests How do you perform basic comparisons of samples? How do you calculate test statistics, what do they mean, and when is something significant? This chapter covers everything you need to know about basic significance tests for GRS, including the \\(t\\)-test, \\(\\chi^2\\)-test, and multiple testing correction. 5.1 T-Test A test for comparing two group means. The data-generating process is assumed to follow a normal distribution, given the group. 5.1.1 Choosing the right \\(t\\)-test Watch part 1 of the \\(t\\)-test lecture and answer the questions below. 5.1.2 Exercises Suppose you measured the beak dimensions (length, depth) of three Geospiza fortis and three Geospiza scandens finches. Copy the code below to enter the example data into R: fortis_length &lt;- c(11.00, 10.60, 11.43) fortis_depth &lt;- c(9.70, 9.30, 10.28) scandens_length &lt;- c(12.90, 14.20, 14.00) scandens_depth &lt;- c(7.90, 9.10, 8.80) Is there a significant difference in mean beak length at \\(\\alpha = 0.05\\)? Use an appropriate \\(t\\)-test. Is there a significant difference in mean beak depth at \\(\\alpha = 0.05\\)? Use an appropriate \\(t\\)-test. If you use a Wilcoxon test instead of a \\(t\\)-test, how does this affect your conclusion? Suppose you measure three juvenile G. fortis finches, tag them, and then measure them again once they reach adulthood: juvenile_length &lt;- c(8.69, 7.69, 8.11) juvenile_depth &lt;- c(9.44, 7.22, 8.38) adult_length &lt;- c(11.50, 9.70, 10.40) adult_depth &lt;- c(9.50, 8.00, 8.80) Is there a significant difference in mean beak length at \\(\\alpha = 0.05\\)? Use an appropriate \\(t\\)-test. Is there a significant difference in mean beak depth at \\(\\alpha = 0.05\\)? Use an appropriate \\(t\\)-test. 5.1.3 Understanding how the \\(t\\)-test works Watch part 2 of the \\(t\\)-test lecture and answer the questions below. 5.1.4 Exercises Interpreting output is an important part of the exam. The questions on the exam will usually be no harder than this, so if you get these right, your understanding of the subject matter is sufficient. (If you want to review specific parts of the video, there are chapters if you watch it in a separate window.) Below is the (partial) output of a \\(t\\)-test. What kind of \\(t\\)-test is this? t = -1.8608, df = 17.776, p-value = 0.07939 alternative hypothesis: true difference in means is not equal to 0 95 percent confidence interval: -3.3654832 0.2054832 sample estimates: mean in group 1 mean in group 2 0.75 2.33 Use the output shown above to determine what the standard error (\\(\\text{SE}\\)) was. Below is the output of another \\(t\\)-test on the same data. What kind of \\(t\\)-test was used here? t = -1.8608, df = 17.776, p-value = 0.0397 alternative hypothesis: true difference in means is less than 0 95 percent confidence interval: -Inf -0.1066185 sample estimates: mean in group 1 mean in group 2 0.75 2.33 Compare the \\(p\\)-value of the first and second \\(t\\)-test. What do you notice? What was the total sample size of the data used in the \\(t\\)-test below? t = -4.9005, df = 38, p-value = 1.811e-05 alternative hypothesis: true difference in means is not equal to 0 95 percent confidence interval: -8.994387 -3.735613 sample estimates: mean in group 1 mean in group 2 19.735 26.100 Using your answer from (5) and the output, can you calculate the standard deviation (\\(s\\))? 5.2 Chi-Squared Test A test for comparing observed to expected frequencies (counts). Can also be used for contingency tables. 5.2.1 Lecture Watch the lecture on the \\(\\chi^2\\)-test and answer the questions below. 5.2.2 Exercises Suppose a vaccine is reported to prevent \\(95\\%\\) of virus infections in healthy adults. The vaccine is given to \\(1000\\) healthy adults, all of which are expected to be exposed to the virus. If \\(63\\) individuals end up being infected, is there a significant deviation from the reported effectiveness at \\(\\alpha = 0.05\\)? Below is a \\(2 \\times 2\\) contingency table: male female left-handed 59 455 right-handed 40 479 With \\(\\alpha = 0.05\\), is there a difference in the \\(\\text{male}:\\text{female}\\) ratio of left and right-handed individuals? For larger contingency tables, a \\(p\\)-value alone does not quite paint the picture of what is going on. This is why there have been quite a few attempts to make visual summaries of categorical data. One such example is a mosaic plot. The code below generates a mosaic plot for the hair and eye color frequencies of \\(592\\) individuals.1 Copy the code to R and run it. Can you tell which combinations are less common in females than in males? mosaicplot(HairEyeColor) 5.3 Multiple Testing If a study involves testing more than one hypothesis, then there is an increased chance of a false positive. 5.3.1 Lecture Watch the lecture on multiple testing and answer the questions below. 5.3.2 Exercises Suppose a paper compares \\(10\\) different diets with paired \\(t\\)-tests (before and after), to find out which diets result in a significant reduction in fat mass. If a level of significance \\(\\alpha = 0.05\\) is used and no multiple testing correction is applied, what is the chance of at least one false positive? Suppose the results of the paper described in the previous question are the ten \\(p\\)-values shown below. Copy the code to your R markdown file and answer the following questions: pvalues &lt;- c(`diet 1` = 0.06936, `diet 2` = 0.81778, `diet 3` = 0.94262, `diet 4` = 0.26938, `diet 5` = 0.16935, `diet 6` = 0.03390, `diet 7` = 0.17879, `diet 8` = 0.64167, `diet 9` = 0.02288, `diet 10` = 0.00832) Which diets have a significant effect after Bonferroni correction? Which diets have a significant effect after FDR correction? Why are some \\(p\\)-values equal to \\(1\\) after correction? There have been many criticisms of the over-reliance of scientific papers on \\(p\\)-values. This is in part because there are many incorrect interpretations being used in papers, and in part because problems like multiple testing, stopping rules and stepwise regression are often left unaddressed. This is one of the major reasons for the ongoing reproducibility crisis. Which of the following interpretations are incorrect? The \\(p\\)-value is: The chance of a false positive; The chance that the null-hypothesis is false; The chance that the null-hypothesis is correct; The chance that the alternative hypothesis is false; \\(1\\) minus the chance that the alternative hypothesis is correct; The probability that the results arose by chance; The chance that the test statistic is this large, or larger, if the null-hypothesis were correct; If the null-hypothesis were true, and the experiment were repeated a large number of times, then the \\(p\\)-value is the expected proportion of experiments with this larger, or larger a test statistic. A solution to the reproducibility crisis proposed by some groups is to lower the commonly used standard of \\(\\alpha = 0.05\\) to some lower value, like \\(\\alpha = 0.005\\). Why is this solution problematic? What would be a better solution? Below is a comic from xkcd.com. What is meant by this comic? Snee, R. D. (1974): Graphical display of two-way contingency tables. The American Statistician, 28, 912. doi: 10.2307/2683520. "],["anova.html", "Chapter 6 ANOVA 6.1 Overview 6.2 How does ANOVA work? 6.3 Two-Way, Multi-Way &amp; Interaction 6.4 Where is part 4? (*)", " Chapter 6 ANOVA Analysis of variance (ANOVA) is a model for comparing any number of group means. The observations are assumed to be independent, deviations from the group means are assumed to follow a normal distribution, and group variances are assumed to be equal. 6.1 Overview Watch part 1 of the ANOVA lecture and answer the questions below. 6.1.1 Exercises The PlantGrowth data set is included with the default installation of R. It contains \\(30\\) independent measurements of dry weight from plants subjected to three types of treatment. You can view it by running View(PlantGrowth) in the console, or you can see the structure of the data and produce a summary of the data like this: str(PlantGrowth) summary(PlantGrowth) Make a plot showing the weight of the different groups. You can use the same kind of plot as shown in the video. Fit an ANOVA and save it as an object called ANOVA. Here is the code I used in the video to perform visual diagnostics. Run it and comment on the plots.2 require(&quot;car&quot;) # Install if missing par(mfrow = c(2, 2)) # Plot in a 2x2 grid plot(ANOVA, which = 1) # Residuals vs fitted qqPlot(ANOVA, reps = 1e4) # QQ-plot. See footnote for errors plot(ANOVA, which = 3) # Scale-location plot(ANOVA, which = 4) # Cook&#39;s distance par(mfrow = c(1, 1)) # Restore the default Perform the omnibus test. Is there a difference in weight among any of the groups? Perform a post hoc analysis. Which group means differ significantly? 6.2 How does ANOVA work? Watch part 2 of the ANOVA lecture and answer the questions below. 6.2.1 Exercises Are the following statements true or false? The omnibus test is used to see which of \\(k\\) group means differ; The omnibus test is an \\(F\\)-test; The residual variance is smaller than the total variance in the outcome; The \\(p\\)-value is the chance of obtaining an \\(F\\)-value at least this large if there were no differences in group means; The post hoc of a one-way ANOVA must still be corrected for multiple testing. Below is the output of an omnibus test of some data: Df Sum Sq Mean Sq F value Pr(&gt;F) Species 2 63.21 31.606 119.3 &lt;2e-16 *** Residuals 147 38.96 0.265 What is the number of groups? What is the total sample size? What does Pr(&gt;F) mean? Here is another omnibus test, but with some values omitted: Df Sum Sq Mean Sq F value Pr(&gt;F) Group x 3488 697.5 z 0.000277 *** Residuals 48 5745 y What is the value of x? What is the value of y? What is the value of z? Why do we bother with an omnibus test, why not just use the post hoc immediately after fitting the model? 6.3 Two-Way, Multi-Way &amp; Interaction Watch part 3 of the ANOVA lecture and answer the questions below. 6.3.1 Exercises In an experiment on rats, a researcher wanted to find out what the effect would be of the genotype of the biological mother and the foster mother on the growth of the rats.3 \\(61\\) rat litters were taken from their biological mother and placed with a foster mother. See the figure below. Which is suitable here: One-way, two-way, or multi-way ANOVA? Do you expect an interaction or main effects here? Explain. Based on your answer to the previous question, run an appropriate ANOVA for this data set. Perform visual diagnostics, look at the summary, and perform a post hoc analysis. Write a short conclusion. The data set is called genotype and you can access it by loading the package MASS: require(&quot;MASS&quot;) # Comes preinstalled with R str(genotype) summary(genotype) (hard) Search online for the definition of the central limit theorem. Is normality of the residuals a reasonable assumption for this study from a theoretical point of view? (HINT: Look at the help page for the genotype data set and read the description of the outcome variable.) 6.3.2 Additional Exercises (*) The iris data set is included with the default installation of R. It contains \\(150\\) independent measurements of sepal and petal dimensions from three types of Iris species. Choose one of: Sepal.Length, Petal.Length, Sepal.Width and Petal.Width and perform a complete analysis to find out whether species differ on average. In this exercise we are going to calculate how much variance your ANOVA from the previous exercise has explained. Remember the animation from the video: Estimate the total variance in the outcome using var(); Estimate the residual variance. You can obtain the residuals of a model using residuals() on the fitted model; The variance explained is one minus the proportion of the total variance that remains after fitting the model. How much variance did your model explain? If your model is called ANOVA, then you can check your answer as follows: summary(lm(ANOVA))$r.squared. Did you get the calculation right? This value will be explained again in the linear regression lectures. 6.4 Where is part 4? (*) When you use two- or multi-way ANOVA, Tukeys Honest Significant Difference only corrects for the categories within each explanatory variable. This quickly becomes problematic: If youll recall from the multiple testing lecture, with \\(\\alpha = 0.05\\), with as little as three explanatory variables, you will already have a chance of \\(1 - (1 - 0.05)^3 \\approx 14.3\\%\\) chance of at least one false positive among all comparisons. In order to correct for this, you would need to somehow obtain uncorrected \\(p\\)-values from TukeyHSD and then perform multiple testing correction for the total number of comparisons. This is unfortunately not very easy to do, so Dr. van Mil and I decided that it would not be part of the GRS course. We will include this in the Advanced Statistics course for master students. If you are interested, or need this for your internship, please have a look at the vignettes of the emmeans package, or wait for me to release part 4 after the course. What a vignette is, is covered in the video on help files. List of problems and how to fix them: (1) If you get an error about a missing package, install car using install.packages(\"car\"), then run diagnostic plots code again. (2) If you cant install car, replace qqPlot(ANOVA, reps = 10e4) with: plot(ANOVA, which = 2). (3) If you get an error about figure margins being too small, simply enlarge your plot pane as shown here, then run the diagnostic plots code again. Bailey, D. W. (1953): The Inheritance of Maternal Influences on the Growth of the Rat. Unpublished Ph.D. thesis, University of California. Table B of the Appendix. "],["simple-linear-regression.html", "Chapter 7 Simple Linear Regression 7.1 Overview 7.2 Model Diagnostics", " Chapter 7 Simple Linear Regression A model for a continuous response variable and a continuous explanatory variable, between which a linear relationship is assumed. The data-generating process is assumed to follow a normal distribution, given the effect of the explanatory variable. 7.1 Overview Here is the illustration of the intercept and slope: Here is the illustration of the residuals: 7.1.1 Exercise 7.2 Model Diagnostics 7.2.1 Exercises "],["multiple-linear-regression.html", "Chapter 8 Multiple Linear Regression 8.1 Lecture: Multiple Linear Regression 8.2 Exercises", " Chapter 8 Multiple Linear Regression A model for a continuous response variable and any number of explanatory variables (continuous and/or categorical). The data-generating process is assumed to follow a normal distribution, given the effects of the explanatory variables. 8.1 Lecture: Multiple Linear Regression 8.2 Exercises "],["model-selection.html", "Chapter 9 Model Selection 9.1 Lecture: Model Selection 9.2 Exercises", " Chapter 9 Model Selection Guidelines for choosing the right model. The best model depends on what the model is intended to be used for. 9.1 Lecture: Model Selection 9.2 Exercises In order to study the effect of caviar on health, a survey is distributed in a city on whether the respondents have ever eaten caviar, and if so, how frequently they eat caviar. After receiving the responses, 100 random individuals from each of the following groups are invited for a health check-up: Group A: Has never consumed caviar; Group B: Has tried caviar once, or a few times in their life; Group C: Eats caviar about once per year; Group D: Eats caviar multiple times per year; Group E: Eats caviar about once per month. What problems do you think there might be with this study design? "],["glm.html", "Chapter 10 GLM 10.1 Lecture: GLM 10.2 Exercises", " Chapter 10 GLM A model for a continuous response variable and any number of explanatory variables (continuous and/or categorical). The data-generating process can follow any distribution in the exponential dispersion family. 10.1 Lecture: GLM 10.2 Exercises "],["pca.html", "Chapter 11 PCA 11.1 Lecture: PCA 11.2 Exercises", " Chapter 11 PCA An exploratory technique for explaining the variance among a group of continuous variables, by creating linear combinations. 11.1 Lecture: PCA 11.2 Exercises "],["overview-of-techniques.html", "Chapter 12 Overview of Techniques 12.1 Lecture: Overview 12.2 Exercises", " Chapter 12 Overview of Techniques A summary of all techniques discussed in the previous days, and how they relate to each other. 12.1 Lecture: Overview 12.2 Exercises "]]
